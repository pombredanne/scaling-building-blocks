<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Scalability Workshop</title>

	<meta name="description" content="Prepare your website for the big show.">
	<meta name="author" content="val.hoffman@gmail.com, val@tikalk.com" />
	<meta name="viewport" content="width=device-width, maximum-scale=1.0, initial-scale=1.0, user-scalable=yes" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<link href="simple.css" rel="stylesheet" type="text/css" />
	<link href="basic-animations.css" rel="stylesheet" type="text/css" />

	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="jmpress.js"></script>
</head>
<body>

<div id="simple">
	<div id="home" ~s>
		<h1 ~m>What will be covered</h1>
		<ul>
			<li ~m>When we will need this?</li>
			<li ~m>Concurrent massive landing</li>
			<li ~m>The system is under stress</li>
			<li ~m>Response time is growing</li>
			<li ~m>If you want peaceful life, prepare yourself for the battle!</li>
		</ul>
		<br/>
		<h2 ~m>Prerequisites</h2>
		<p ~m>sudo apt-get install siege memcached redis<p>
	</div>

	<div id="home" ~s>
		<h2 ~m>Main Topics</h2>
		<ul>
			<li ~m>Optimize the code</li>
				<ul>
					<li ~m>Profile, find bottlenecks with existing tools</li>
					<li ~m>Delayed Jobs</li>
					<li ~m>Replace software with services</li>
						<ul>
							<li ~m>Solr for search</li>
							<li ~m>Sinatra for computations etc.</li>
						</ul>
				</ul>
			<li ~m>Database tweaks</li>
			<ul>
				<li ~m>In-memory DB - Redis</li>
				<li ~m>Fine-tune existing MySQL database:</li>
					<ul>
					<li ~m>Indexes</li>
					<li ~m>Configuration</li>
					<li ~m>De-normalization</li>
					</ul>
			</ul>
			<li ~m>Types of caching</li>
			<li ~m>JRuby</li>
			<li ~m>Adding Hardware</li>
		</ul>
	</div>

	<div ~s>
		<h2 ~m>Add the cache</h2>

		<h3  ~m>Add to development.rb:</h3>
		<ul>
			<li ~m>config.action_controller.perform_caching = true</li>
			<li ~m>config.cache_store = :file_store, "#{Rails.root}/tmp/cache"</li>
		</ul>

		<h3 ~m>And add to the products controller:</h3>
		<ul>
			<li ~m>caches_action :galery, :cache_path => :products_cache_path.to_proc</li>
			<li ~m>def products_cache_path<br/>
			current_user_id = current_user.nil?? 0 : current_user.id<br/>
			"home_index/#{params[:page]}/#{current_user_id}"<br/>
		end<br/></li>
		</ul>
		
		<div ~m style="background: #eee">
			Transaction rate:	       84.42 trans/sec   <span data-jmpress="drive-left after 4000ms step" style="color:#4f4">WOW!!</span><br/>
			And once again:<br/>
			Transaction rate:	       91.20 trans/sec   (Which makes sense.) <span data-jmpress="drive-left after 4300ms step" style="color:#4f4">Weee!!</span><br/><br/>
		</div>
	</div>
	<div ~s>
		<h3 ~m>rails s Puma:</h3>
		<div ~m>
			Transaction rate:	       97.84 trans/sec  (Even better)<br/>

			[More detailed explanation of caches_action goes here, in addition to descriptions of other caching types]<br/>
			http://guides.rubyonrails.org/caching_with_rails.html<br/>
		</div>
	</div>
	<div ~s>
		<p ~m>You might think it is boring...</p>
	</div>
	<div ~s>
		<p ~m>but that is the point. This is a simple example.</p>
	</div>
	<div ~s>
		<p ~m><b>substep 0 + 1s</b></p>
    </div>
</div>

<script type="text/javascript">
$(function() {
	$('#simple').jmpress();
});
</script>

</body>
</html>